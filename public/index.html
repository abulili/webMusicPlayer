<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="./js/vue.js"></script>
    <link rel="stylesheet" href="./css/eui.css">
    <script src="./js/eui.js"></script>
    <script src="./js/axios.min.js"></script>
    <link rel="stylesheet" href="./css/index.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css">

</head>

<body>
    <div id="app">
        <el-container>
            <el-header height="160px">
                <div>
                    <el-menu :default-active="activeIndex" class="el-menu-demo menu" mode="horizontal"
                        @select="handleSelect">
                        <el-menu-item index="0" style="float: left;"><img src="./imgs/ÂõæÊ†á.jpg" alt=""
                                class="pic-1"></el-menu-item>
                        <el-menu-item index="1" style="margin-left: 100px;"><input type="text" placeholder="ËØ∑ËæìÂÖ•ÊêúÁ¥¢ÂÜÖÂÆπ"
                                v-model="searchValue" class="inp-11"><button @click="serachMusic"
                                class="but-11">Ê≠åÂêçüîç</button></el-menu-item>
                        <el-menu-item index="3" style="float: right;" @click="location.href = '/login.html'"
                            v-show="isLogin === false">ÁôªÂΩï</el-menu-item>
                        <el-menu-item index="3" style="float: right;" @click="logout"
                            v-show="isLogin === true">ÈÄÄÂá∫ÁôªÂΩï</el-menu-item>
                        <el-menu-item style="float: right;"> <el-divider
                                direction="vertical"></el-divider></el-menu-item>
                        <el-menu-item index="3" style="float: right;" @click="changeSelf"
                            v-show="isLogin === true">‰øÆÊîπ‰∏™‰∫∫‰ø°ÊÅØ</el-menu-item>
                        <el-menu-item index="2" style="float: right;"><a href="/updateMusic.html"
                                v-show="isLogin === true">‰∏ä‰º†Èü≥‰πê</a></el-menu-item>
                        <el-menu-item index="1" style="float: right;" @click="selfMusic"
                            v-show="isLogin === true">ÊàëÁöÑÂñúÊ¨¢</el-menu-item>
                        <el-menu-item index="1" style="float: right;" @click="location.href='/manage.html'"
                            v-show="admin == 1">ÁÆ°ÁêÜ</el-menu-item>
                    </el-menu>
                </div>
                <div>
                    <el-menu :default-active="activeIndex" class="el-menu-demo" mode="horizontal"
                        @select="handleSelect">
                        <el-row>
                            <el-col :span="12"><el-menu-item index="1">È¶ñÈ°µ</el-menu-item></el-col>
                            <!-- <el-col :span="8"> <el-menu-item index="2">Ê≠åÊâã</el-menu-item></el-col> -->
                            <!-- <el-col :span="6"><el-menu-item index="3">Ê¶úÂçï</el-menu-item></el-col> -->
                            <el-col :span="12"><el-menu-item index="4">ÂàÜÁ±ª</el-menu-item></el-col>
                        </el-row>
                    </el-menu>
                </div>
            </el-header>
            <el-main>
                <div v-if="activeIndex == 1">
                    <div class="banner">
                        <div id="slide" :default-active="bannerIndex" ref="slide">
                            <div class="item" style="background-image: url(./imgs/1.jpg);" index="1">
                                <div class="content">
                                    <div class="name">Á≤æÈÄâÂ•ΩÊ≠å</div>
                                    <button>Êü•ÁúãÊõ¥Â§ö</button>
                                </div>
                            </div>
                            <div class="item" style="background-image: url(./imgs/2.jpg);" index="2">
                                <div class="content">
                                    <div class="name">Á≤æÈÄâÂ•ΩÊ≠å</div>
                                    <button>Êü•ÁúãÊõ¥Â§ö</button>
                                </div>
                            </div>
                            <div class="item" style="background-image: url(./imgs/3.jpg);" index="3">
                                <div class="content">
                                    <div class="name">Á≤æÈÄâÂ•ΩÊ≠å</div>
                                    <button>Êü•ÁúãÊõ¥Â§ö</button>
                                </div>
                            </div>
                            <div class="item" style="background-image: url(./imgs/4.jpg);" index="4">
                                <div class="content">
                                    <div class="name">Á≤æÈÄâÂ•ΩÊ≠å</div>
                                    <button>Êü•ÁúãÊõ¥Â§ö</button>
                                </div>
                            </div>
                            <div class="item" style="background-image: url(./imgs/5.jpg);" index="5">
                                <div class="content">
                                    <div class="name">Á≤æÈÄâÂ•ΩÊ≠å</div>
                                    <button>Êü•ÁúãÊõ¥Â§ö</button>
                                </div>
                            </div>
                            <div class="item" style="background-image: url(./imgs/6.jpg);" index="6">
                                <div class="content">
                                    <div class="name">Á≤æÈÄâÂ•ΩÊ≠å</div>
                                    <button>Êü•ÁúãÊõ¥Â§ö</button>
                                </div>
                            </div>
                        </div>
                        <div class="buttons">
                            <button @click="prev"><i class="fa-solid fa-angle-left"></i></button>
                            <button @click="next" class="next"><i class="fa-solid fa-angle-right"></i></button>
                        </div>
                    </div>
                    <el-row :gutter="20">
                        <el-col :span="16">
                            <h2>Á≤æÈÄâÊ≠åÊõ≤</h2>
                            <el-row :gutter="20" v-for="(row, rowIndex) in Math.ceil(MusicList.length / 4)"
                                :key="rowIndex">
                                <el-col :span="6"
                                    v-for="(item, colIndex) in MusicList.slice(rowIndex * 4, (rowIndex + 1) * 4)"
                                    :key="colIndex">
                                    <el-card :body-style="{ padding: '0px' }">
                                        <img :src="item.Imgurl" class="image" style="cursor: pointer;"
                                            @click="location.href='./musicDetail.html?id=' + item.id">
                                        <div class="char">
                                            <span>{{item.title}}</span>
                                        </div>
                                    </el-card>
                                </el-col>
                                <!-- <el-col :span="6">
                                    <el-card :body-style="{ padding: '0px' }">
                                        <img src="https://shadow.elemecdn.com/app/element/hamburger.9cf7b091-55e9-11e9-a976-7f4d0b07eef6.png"
                                            class="image">
                                        <div class="char">
                                            <span>Â•ΩÂêÉÁöÑÊ±âÂ†°</span>
                                        </div>
                                    </el-card>
                                </el-col>
                                <el-col :span="6">
                                    <el-card :body-style="{ padding: '0px' }">
                                        <img src="https://shadow.elemecdn.com/app/element/hamburger.9cf7b091-55e9-11e9-a976-7f4d0b07eef6.png"
                                            class="image">
                                        <div class="char">
                                            <span>Â•ΩÂêÉÁöÑÊ±âÂ†°</span>
                                        </div>
                                    </el-card>
                                </el-col>
                                <el-col :span="6">
                                    <el-card :body-style="{ padding: '0px' }">
                                        <img src="https://shadow.elemecdn.com/app/element/hamburger.9cf7b091-55e9-11e9-a976-7f4d0b07eef6.png"
                                            class="image">
                                        <div class="char">
                                            <span>Â•ΩÂêÉÁöÑÊ±âÂ†°</span>
                                        </div>
                                    </el-card>
                                </el-col> -->
                            </el-row>
                        </el-col>
                        <el-col :span="8">
                            <h3>ÊéíË°åÊ¶ú(ÈùôÊÄÅ,‰∏çÂèØÁÇπÂáª)</h3>
                            <div class="grid-content bg-purple" height="200px">
                                <el-row :gutter="10">
                                    <el-col :span="10">
                                        <img src="./imgs/6.jpg" alt="" width="260px" height="260px" class="rankImg">
                                    </el-col>
                                    <el-col :span="14">
                                        <div>
                                            <div class="rankk">1.Áà±Â¶ÇÁÅ´</div>
                                            <div class="rankk">2.Áâµ‰∏ùÊàè</div>
                                            <div class="rankk">3.Ëµ∑È£é‰∫Ü</div>
                                        </div>
                                    </el-col>
                                </el-row>
                            </div>
                            <div class="grid-content bg-purple" height="200px">
                                ÂπøÂëäÊé®Ëçê
                                <img src="./imgs/5.jpg" alt="" width="100%">
                            </div>
                        </el-col>
                    </el-row>
                </div>

                <!-- <div v-if="activeIndex == 2">
                    ÂàóÂá∫Ê≠åÊâã,ÂàóÂá∫Ê≠åÊõ≤Âêç
                    ÁÆó‰∫Ü,ÊîæËøáËá™Â∑±
                </div> -->
                <!-- <div v-if="activeIndex == 3">
                    Ê¶úÂçï
                    Âà´Êêû‰∫Ü,Áúü‰∏çÊÉ≥Êêû‰∫Ü
                </div> -->
                <div v-if="activeIndex == 4">
                    <!-- ÂàÜÁ±ª
                    Êù•‰∏™Ê†áÁ≠æ? -->
                    <div>
                        <el-tag :type="type1" @click="clickTag(1)">ÁÉ≠Ê≠å</el-tag>
                        <el-tag :type="type2" @click="clickTag(2)">Âè§È£é</el-tag>
                    </div>
                    <div>
                        <el-table :data="tagList" stripe style="width: 100%">
                            <el-table-column width="180px" type="index">
                            </el-table-column>
                            <el-table-column prop="categroy" label="Á±ªÂà´">
                            </el-table-column>
                            <el-table-column prop="title" label="Ê≠åÂêç">
                            </el-table-column>
                            <el-table-column prop="author" label="Ê≠åÊâã">
                            </el-table-column>
                            <el-table-column label="Êí≠Êîæ">
                                <template slot-scope="scope">
                                    <el-button :icon="icon" circle
                                        @click="location.href='/musicDetail.html?id=' + scope.row.id"></el-button>
                                </template>
                            </el-table-column>
                            <!-- <el-table-column prop="like" label="Êî∂Ëóè">
                                <template slot-scope="scope">
                                    <el-button :type="type" icon="el-icon-star-on" circle
                                        @click="delLike(scope.$index)"></el-button>
                                </template>
                            </el-table-column> -->

                        </el-table>
                    </div>
                </div>


            </el-main>

            <el-footer>
                È°πÁõÆÁâàÊùÉÊâÄÊúâ@13ÁªÑ-Â£πËø©‰∏â
            </el-footer>
        </el-container>
    </div>
</body>
<script>
    let v = new Vue({
        el: '#app',
        data: {
            isLogin: false,
            activeIndex: '1',
            bannerIndex: '0',
            MusicList: [],
            searchValue: '',
            userId: '',
            admin: 0,
            type1: 'info',
            type2: 'info',
            tagList: [],
            icon: 'el-icon-video-play',
            // type: 'primary'
        },
        methods: {
            // ËøôÈáåÊòØÊúâÈóÆÈ¢òÁöÑ
            // delLike(songId) {
            //     console.log(this.likeIdList[songId].id)
            //     if (confirm('ÊòØÂê¶ÂèñÊ∂àÊî∂Ëóè')) {
            //         axios.get('/music/delLike?id=' + this.likeIdList[songId].id).then(res => { })
            //         location.reload()
            //     }

            // },
            clickTag(index) {
                // ‰∏ÄÊ¨°Âè™Êü•‰∏Ä‰∏™
                let categroy = 'ÁÉ≠Ê≠å'
                if (index == 1) {
                    if (this.type2 == 'success') {
                        this.type2 = 'info'
                    }
                    this.type1 = 'success'
                } else if (index == 2) {
                    if (this.type1 == 'success') {
                        this.type1 = 'info'
                    }
                    this.type2 = 'success'
                    categroy = 'Âè§È£é'
                }
                // ÂºÄÂßãÊü•ËØ¢
                axios.get('/music/categroy?categroy=' + categroy).then(res => {
                    this.tagList = res.data
                    console.log(this.tagList)
                })
            },
            selfMusic() {
                location.href = '/selfMusic.html?id=' + this.userId
            },
            changeSelf() {
                location.href = '/changeSelf.html?id=' + this.userId
            },
            handleSelect(key, keyPath) {
                this.activeIndex = key;
                console.log(key, keyPath);
            },
            prev() {
                const slide = this.$refs.slide;
                const items = slide.querySelectorAll('.item');
                const lastItem = items[items.length - 1];
                slide.insertBefore(lastItem, items[0]);
            },
            next() {
                const slide = this.$refs.slide;
                const items = slide.querySelectorAll('.item');
                const firstItem = items[0];
                slide.appendChild(firstItem);
            },
            logout() {
                if (confirm('ÊòØÂê¶ÈÄÄÂá∫Áî®Êà∑')) {
                    axios.get('/user/logout').then(res => {
                        this.isLogin = false
                        location.reload()
                    })
                }
            },
            serachMusic() {
                location.href = '/list.html?wd=' + v.searchValue
            },
            getMusicByCate() {//ÈÄöËøáÂàÜÁ±ªidÊü•ËØ¢Êï∞ÊçÆ
                var cate = location.search.split("=")[1];//Â¶ÇÊûúÂê´Êúâcate,ËØÅÊòéÈúÄË¶ÅÂàÜÁ±ªÊü•ËØ¢,ÊãøÂà∞cateÂÄº
                axios.get('/music/cate?cate=' + cate).then(res => {//Â∞ÜÂàÜÁ±ªid‰º†Âà∞/cateÁ´ØÂè£,ÂæóÂà∞ËøîÂõûÂÄº
                    this.productArr = res.data//Â∞ÜÂàÜÁ±ªÂïÜÂìÅËøîÂõûÂÄºËµãÂÄº
                })
            }
        },
        created() {
            axios.get('/music/list').then(res => {
                this.MusicList = res.data
                let str = this.MusicList.Imgurl
                this.MusicList.Imgurl = str.replace(/\\/g, '/')
                console.log(str, this.MusicList.Imgurl)
                console.log(this.MusicList)
            })
            axios.get('/user/isLogin').then(res => {
                console.log('ÁôªÈôÜÊï∞ÊçÆ:', res.data)
                if (res.data != '') {
                    console.log('Áî®Êà∑Â∑≤ÁôªÂΩï')
                    this.isLogin = true //Âà§Êñ≠ÊòØÂê¶ÁôªÂΩïËµãÂÄºtrue
                    this.userId = res.data.id
                    this.admin = res.data.admin
                } else {
                    console.log('Áî®Êà∑Êú™ÁôªÂΩï')
                }
            })
        },
    })
</script>

</html>